[toc]

## feature

1. 不支持多返回值: golang 支持

   ```golang
   // golang
   func foo() (int, string) {
      return 42, "hello"
   }

   result1, result2 := foo()
   ```

2. 函数参数可以有默认值: `fun read(b: ByteArray, len: Int = b.size) {}`
3. 具名函数参数

   ```kotlin
   fun sendMessage(to: String, message: String, priority: Int = 1) {}
   sendMessage(/*priority = 3,*/ message = "Hello", to = "John")
   ```

4. 函数可以做参数: 并且在最后一位可以变成方法体

   ```kotlin
   fun foo(
      bar: Int = 0,
      baz: Int = 1,
      qux: () -> Unit,
   ) { /*...*/ }

   foo(1) { println("hello") }     // Uses the default value baz = 1
   foo(qux = { println("hello") }) // Uses both default values bar = 0 and baz = 1
   foo { println("hello") }        // Uses both default values bar = 0 and baz = 1
   ```

5. 可以定义嵌套函数

   ```kotlin
   // 阶乘
   fun factorial(n: Int): Int {
      if (n==0) return 1
      return n * factorial(n-1)
   }
   fun factorial(n: Int) : Int {
      tailrec fun factorialInner(n: Int, result: Int): Int {
         if (n == 1) return result
         return factorialInner(n-1, n*result)
      }

      return factorialInner(n, 1)
   }

   // 斐波那契
   fun fibonacci(n: Int): Int {
      if (n < 2) retrun n
      return fibonacci(n-1) + fibonacci(n-2)
   }
   fun fibonacci(n: Int): Int {
      tailrec fun fibonacciInner(n:Int, prev:Int, next:Int):Int {
         if (n < 1) retrun next
         return fibonacciInner(n-1, next, prev + next)
      }

      return fibonacciInner(n, 0, 1)
   }
   ```

6. 函数扩展()

   ```kotlin
   // 对任意对象扩展了 ops 方法, 其返回值为 list
   fun Any.ops(): List<String> =  listOf("as")

   // 对String对象扩展了 todo 方法(报错)
   fun String.todo(): Unit {
      TODO()
   }
   ```

   ```golang
   // golang
   func (c *调用者) 函数名(参数) (返回值){
         函数体
   }
   ```

7. 分类

   - 成员函数
   - 内联(inline)函数: 在编译时插入调用处(不是作为函数调用)
   - 中缀(Infix)函数: 允许以一种更简洁的方式调用函数
   - 扩展函数
   - 高阶函数(lambda)
   - 泛型函数
   - 尾递归函数(tailrec):
     1. 递归调用是最后一个操作则可以修改成尾递归(可以解决栈帧的内存消耗问题-提高运行速度)
     2. 编译器会将其优化成循环实现
     3. 典型实现(在内部定义尾递归): 阶乘 | 斐波那契数

## declare

1. 函数定义: `fun NAME(VAR_NAME VAR_TYPE) : RETURN_TYPE`

   ```kotlin
   // 1.简单定义
   fun sum(a: Int, b: Int): Int {
       return a + b
   }

   // 2.等价于
   fun sum(a: Int, b: Int) = a + b
      fun sum(a: Int, b: Int): Int = a + b

   // 3.返回值类型为Unit可以省略
   fun printSum(a: Int, b: Int) = println("sum of $a and $b is ${a + b}")
   ```

2. 构造函数

   ```kotlin
   open class A { }

   class ConClass : A {
       constructor()
       constructor(s: String): this()
   }
   ```

3. 可变长度参数: varargs

   ```kotlin
   // val list = asList(1, "2", 3)
   fun <T> asList(vararg ts: T): List<T> {
      val result = ArrayList<T>()
      for (t in ts)  result.add(t)
      return result
   }
   ```

4. Infix

   ```kotlin
   class MyStringCollection {
      infix fun add(s: String) { /*...*/ }
      fun build() {
         this add "abc"   // Correct
         add("abc")       // Correct
         //add "abc"        // Incorrect: the receiver must be specified
      }
   }

   // 1.shl(2)  // 1 shl 2
   ```

5. 成员函数: 定义在类或 object 的函数

## 多返回值(不支持): 可以解耦

1. 数据类

   ```kotlin
   data class Person(var name: String, var age: Int, var gender: Char)
   fun fetchPersonDetails(): Person {xxx}
   fun main() {
      val (name, age, gender) = fetchPersonDetails()    // 解构声明
   }
   ```

2. Pair/Triple 类

   ```kotlin
   fun fetchPersonDetails(): Triple<String, Int, Char> {
      return Triple(name, age, gender)
   }

   fun main() {
      val (name, age, gender) = fetchPersonDetails()
   }
   ```

3. 返回一个数组

   ```kotlin
   fun fetchPersonDetails(): Array<Any> {
      return arrayOf(name, age, gender)
   }

   fun main() {
      val (name, age, gender) = fetchPersonDetails()
   }
   ```

## build-in func
